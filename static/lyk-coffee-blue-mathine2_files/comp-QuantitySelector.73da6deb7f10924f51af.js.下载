(window.webpackJsonpCrema=window.webpackJsonpCrema||[]).push([[27],{467:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t};function r(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var u=b(a(0)),o=b(a(6)),i=a(5),l=b(a(35)),s=b(a(108)),d=b(a(701)),c=b(a(25)),f=b(a(54)),p=a(98),y=(b(a(1)),a(656)),m=a(28),_=a(21),h=b(a(41)),v=b(a(713));function b(t){return t&&t.__esModule?t:{default:t}}var Q=["quantitySelector","buttonFocusId"],E=["quantitySelector","orientation"],g=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(M,u.default.Component),function(t,e,a){e&&r(t.prototype,e),a&&r(t,a)}(M,[{key:"componentWillReceiveProps",value:function(t){!t.isOpen&&this.props.isOpen&&setTimeout(this.handleClose,0)}},{key:"getPredefinedQuantities",value:function(){var t=this.props,e=t.quantitySelector,a=t.thirdLine;return(0,y.getDisplayableQuantities)(e.product,a)}},{key:"positionQuantitySelector",value:function(t){var e=(0,l.default)(this.props,Q);if(e){var a=document.getElementById(e),n=(0,l.default)(this.props,E),r=(0,y.getQuantitySelectorPosition)(n,a);this.setState({position:r}),(0,m.focus)("PredefinedQuantityList__quantity-focusable"),this.trapped=(0,s.default)("#QuantitySelector__wrapper",{clickOutsideDeactivates:!0,escapeDeactivates:!1,returnFocusOnDeactivate:!1}),this.trapped.activate(),this.props.isOpen||(this.props.assignContainer(t),this.props.open(null,this.props.isNarrow))}}},{key:"handleUpdateQuantity",value:function(t,e){var a=this;return this.props.quantitySelector.updateProductQuantity(t,e).then(function(){a.handleClose(),a.props.close()})}},{key:"handleCloseOnEsc",value:function(t){27===t.which&&this.props.close()}},{key:"handleClose",value:function(){var t=(0,l.default)(this.props,Q);this.props.handleCloseQuantitySelector(),this.trapped.deactivate(),(0,m.focus)(t)}},{key:"render",value:function(){var t=this.props,e=t.quantitySelector,a=t.salesMultipleError,r=t.maximumAmountError,o=t.invalidQuantityError,i=t.roundingMessage;if(!e||!0===e.unNeededQuantitySelector)return null;var s={salesMultipleError:a,maximumAmountError:r,invalidQuantityError:o,roundingMessage:i},c=(0,l.default)(this.props,Q);return u.default.createElement(v.default,{domElementId:c},u.default.createElement(d.default,n({positionQuantitySelector:this.positionQuantitySelector,handleUpdateQuantity:this.handleUpdateQuantity,handleCloseOnEsc:this.handleCloseOnEsc,quantities:this.getPredefinedQuantities(),position:this.state.position,product:(0,l.default)(e,"product"),customQuantityError:(0,l.default)(e,"customQuantityError"),customErrorMessages:s},this.props)))}}]),M);function M(t){!function(t,e){if(!(t instanceof M))throw new TypeError("Cannot call a class as a function")}(this);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(M.__proto__||Object.getPrototypeOf(M)).call(this,t));return e.handleClose=e.handleClose.bind(e),e.handleCloseOnEsc=e.handleCloseOnEsc.bind(e),e.handleUpdateQuantity=e.handleUpdateQuantity.bind(e),e.positionQuantitySelector=e.positionQuantitySelector.bind(e),e.state={position:"top"},e}g.defaultProps={quantitySelector:{}};var P=(0,o.default)((0,i.connect)(function(t){var e=t.quantitySelector,a=t.viewport;return{quantitySelector:e,isNarrow:(0,_.isNarrow)(a.formFactor)}},function(t){return{handleCloseQuantitySelector:function(){return t((0,p.closeQuantitySelector)())},updateCustomQuantityErrorMessage:function(e){return t((0,p.setCustomQuantityError)(e))}}}),(0,c.default)({a11yDescription:"quantityselector.a11y.dialog.description",a11yTitle:"quantityselector.a11y.dialog.title",a11yRemoveProductLabel:"quantityselector.a11y.removeproduct.label",a11yAddProductLabel:"quantityselector.a11y.addproduct.label",a11yUpdateProductLabel:"quantityselector.a11y.updateproduct.label",salesMultipleError:"quantityselector.customquantity.error.salesMultiple",maximumAmountError:"quantityselector.customquantity.error.maximumAmount",invalidQuantityError:"quantityselector.customquantity.error.invalidQuantity",roundingMessage:"quantityselector.customquantity.rounding.message",chooseHintLabel:"quantityselector.choosehint.label",okButtonLabel:"quantityselector.okbutton.label"}),f.default,(0,h.default)({overlay:!1}));e.default=u.default.memo(P(g))},598:function(t,e,a){"use strict";function n(t,e,a){var n=[],r=function(t,e,a){var n=e-t;return Math.ceil(Math.abs(n)/Math.abs(a||1))}(t,e,a);if(r){n.length=r;for(var u=t,o=0;o<r;o+=1)n[o]=u,u+=a}return n}function r(t,e){return t<e?1:e<t?-1:0}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,a){return"number"!=typeof t?[]:"number"!=typeof e?n(0,t,r(0,t)):n(t,e,"number"==typeof a?a:r(t,e))}},656:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getCustomQuantityError=e.getDisplayableQuantities=e.getQuantitySelectorPosition=void 0;var n=i(a(598)),r=i(a(705)),u=a(53),o=a(98);function i(t){return t&&t.__esModule?t:{default:t}}function l(t){if(Array.isArray(t)){for(var e=0,a=Array(t.length);e<t.length;e++)a[e]=t[e];return a}return Array.from(t)}e.getQuantitySelectorPosition=function(t,e){if("left"===t)return"left";var a=e.getBoundingClientRect();return a.right-a.width/2+110>=window.innerWidth?"left":a.top-200<=80?"bottom":t},e.getDisplayableQuantities=function(t,e){var a=1<arguments.length&&void 0!==e?e:[];if(!t)return[];var r=t.type,o=t.salesMultiple,i=t.maxQuantity,s=t.isLimited,d=a.length&&r===u.PRODUCT_TYPE_CAPSULES&&!(0,u.isBundle)(t)&&!s,c=d?15-a.length:15,f=o||1,p=(0,n.default)(0,c).map(function(t){return t*f}),y=[].concat(l(p),l(d?a:[])).filter(function(t){return!i||t<=i});if(y.length%5==0)return y;var m=5-y.length%5;return[].concat(l(y),l((0,n.default)(1,1+m).map(function(t){return i+t*f})))},e.getCustomQuantityError=function(t,e){if(!e)return null;var a=e.salesMultiple||1,n=(0,u.getMaxAddibleQuantity)(e);if(isNaN(t)||!(0,r.default)(t))return{errorType:o.CUSTOM_QUANTITY_ERROR_TYPES.OTHER,newCustomQuantityValue:0};if(t<0)return{errorType:o.CUSTOM_QUANTITY_ERROR_TYPES.OTHER,newCustomQuantityValue:0};if(n<t)return{errorType:o.CUSTOM_QUANTITY_ERROR_TYPES.MAX_QUANTITY,newCustomQuantityValue:n};var i=t%a,l=t-i;if(0==i)return null;var s=l+a<=n?l+a:t-i,d=Math.min(n,s);return{errorType:o.CUSTOM_QUANTITY_ERROR_TYPES.SALES_MULTIPLE,newCustomQuantityValue:d}}},701:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t},r=p(a(0)),u=p(a(3)),o=p(a(4)),i=p(a(35)),l=(p(a(1)),p(a(702))),s=p(a(703)),d=p(a(19)),c=p(a(704)),f=p(a(710));function p(t){return t&&t.__esModule?t:{default:t}}function y(t){var e=t.className,a=t.position,p=t.a11yTitle,y=t.a11yDescription,m=t.handleCloseOnEsc,_=t.positionQuantitySelector,h=t.product,v=t.handleUpdateQuantity,b=t.updateCustomQuantityErrorMessage,Q=t.customQuantityError,E=t.customErrorMessages,g=t.chooseHintLabel,M=t.okButtonLabel,P=t.isNarrow,O=(0,o.default)("QuantitySelector",e),C=(0,o.default)("QuantitySelector__popin",{"QuantitySelector__popin--top":!P&&"top"===a,"QuantitySelector__popin--bottom":!P&&"bottom"===a,"QuantitySelector__popin--left":!P&&"left"===a}),S=(0,u.default)(t,["position","className","product","customQuantityError","customErrorMessages"]);return r.default.createElement("div",{className:O,id:"QuantitySelector__wrapper",ref:_,onKeyDown:m,role:"dialog","aria-labelledby":"QuantitySelector__title","aria-describedby":"QuantitySelector__description"},r.default.createElement(d.default,{id:"QuantitySelector__title",value:p}),r.default.createElement(d.default,{id:"QuantitySelector__description",value:y}),r.default.createElement("div",{className:"QuantitySelector__container"},r.default.createElement("div",{className:C},Q?r.default.createElement(s.default,{product:h,customQuantityError:Q,customErrorMessages:E}):r.default.createElement(l.default,n({productName:(0,i.default)(h,"name"),productId:(0,i.default)(h,"id"),productQuantity:(0,i.default)(h,"quantity"),productMaxCustomerQuantity:(0,i.default)(h,"maxCustomerQuantity"),productMaxQuantity:(0,i.default)(h,"maxQuantity"),handleUpdateQuantity:v},S)),r.default.createElement(c.default,{productId:(0,i.default)(h,"id"),product:h,chooseHintLabel:g,okButtonLabel:M,handleUpdateQuantity:v,updateCustomQuantityErrorMessage:b}),r.default.createElement(f.default,{product:h}))))}a(476),y.defaultProps={position:"top"},e.default=y},702:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t},r=i(a(0)),u=(i(a(1)),i(a(19))),o=i(a(20));function i(t){return t&&t.__esModule?t:{default:t}}a(468),e.default=function(t){if(!t.quantities||!t.productId)return null;var e=t.quantities,a=t.handleUpdateQuantity,i=t.productId,l=t.productName,s=t.productQuantity,d=t.productMaxCustomerQuantity,c=t.productMaxQuantity,f=t.a11yRemoveProductLabel,p=t.a11yAddProductLabel,y=t.a11yUpdateProductLabel;return r.default.createElement("ul",{className:"PredefinedQuantityList"},e.map(function(t,e,a,i,l,s,d,c,f){return function(p,y){var m=(0,o.default)(d,{productName:a}),_=i?f:c,h=(0,o.default)(_,{quantity:p}),v=0===p?r.default.createElement(u.default,{value:m}):r.default.createElement(u.default,{value:h}),b=s<p||"number"==typeof l&&l<p;return r.default.createElement("li",{className:"PredefinedQuantityList__quantity",key:p},r.default.createElement("button",n({id:"ta-quantity-selector__predefined-"+y},0===y?{"data-focus-id":"PredefinedQuantityList__quantity-focusable"}:{},{className:"PredefinedQuantityList__quantity-button",onClick:function(){return t(e,p)},disabled:b}),v,r.default.createElement("span",{"aria-hidden":"true",className:"notranslate"},p)))}}(a,i,l,s,d,c,f,p,y)))}},703:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(a(0)),r=(i(a(1)),i(a(20))),u=a(98),o=a(53);function i(t){return t&&t.__esModule?t:{default:t}}a(469),e.default=function(t){var e=t.customErrorMessages,a=t.customQuantityError,i=t.product;if(!a||!i)return null;var l=a.errorType,s={productQuantity:a.newCustomQuantityValue,salesMultiple:i.salesMultiple,maxQuantity:(0,o.getMaxAddibleQuantity)(i)},d=(0,r.default)(e.roundingMessage,s),c=(0,r.default)(function(t,e){switch(l){case u.CUSTOM_QUANTITY_ERROR_TYPES.MAX_QUANTITY:return e.maximumAmountError;case u.CUSTOM_QUANTITY_ERROR_TYPES.SALES_MULTIPLE:return e.salesMultipleError;default:return e.invalidQuantityError}}(0,e),s);return n.default.createElement("div",{className:"CustomQuantityError",id:"CustomQuantityError"},n.default.createElement("div",{className:"CustomQuantityError__error-message"},c),n.default.createElement("div",{className:"CustomQuantityError__rounding-message"},d))}},704:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});function n(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var r=l(a(0)),u=a(656),o=a(28),i=(l(a(1)),l(a(706)));function l(t){return t&&t.__esModule?t:{default:t}}var s=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(d,r.default.Component),function(t,e,a){e&&n(t.prototype,e),a&&n(t,a)}(d,[{key:"getProps",value:function(){return Object.assign({},this.props,{handleChange:this.handleChange.bind(this),customQuantity:this.state.customQuantity,handleUpdateQuantity:this.handleUpdateQuantityWithValidation.bind(this)})}},{key:"handleChange",value:function(t){var e=t.target.value,a=""!==e?parseInt(e,10):"";this.setState({customQuantity:a})}},{key:"handleUpdateQuantityWithValidation",value:function(t,e){var a=this.props,n=a.product,r=a.updateCustomQuantityErrorMessage,i=a.handleUpdateQuantity,l=(0,u.getCustomQuantityError)(e,n);l?(r(l),this.setState({customQuantity:l.newCustomQuantityValue}),(0,o.focus)("QuantitySelectorCustomField__field")):i(t,e)}},{key:"render",value:function(){var t=this.props.product;return t&&t.isLimited?null:r.default.createElement(i.default,this.getProps())}}]),d);function d(t){!function(t,e){if(!(t instanceof d))throw new TypeError("Cannot call a class as a function")}(this);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,t));return e.state={customQuantity:""},e}e.default=s},705:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=parseInt(t,10);return!Number.isNaN(e)&&e.toString()===t.toString()}},706:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=u(a(0)),r=(u(a(1)),u(a(632)));function u(t){return t&&t.__esModule?t:{default:t}}a(474),e.default=function(t){var e=t.chooseHintLabel,a=t.okButtonLabel,u=t.handleChange,o=t.customQuantity,i=t.handleUpdateQuantity,l=t.productId;return n.default.createElement("form",{className:"QuantitySelectorCustomField__container",onSubmit:function(t){i(l,o),t.preventDefault()},noValidate:!0},n.default.createElement(r.default,{id:"ta-quantity-selector__custom-field","data-focus-id":"QuantitySelectorCustomField__field",type:"number",min:"0",value:o,label:e,onChange:u,cssClass:"QuantitySelectorCustomField__field",inputClassName:"QuantitySelectorCustomField__input","aria-describedby":"CustomQuantityError",isCompact:!0}),n.default.createElement("button",{id:"ta-quantity-selector__custom-ok",className:"QuantitySelectorCustomField__button-ok"},a))}},710:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(711);Object.defineProperty(e,"default",{enumerable:!0,get:function(){return function(t){return t&&t.__esModule?t:{default:t}}(n).default}})},711:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(a(6)),r=i(a(25)),u=i(a(652)),o=i(a(712));function i(t){return t&&t.__esModule?t:{default:t}}var l=(0,n.default)((0,r.default)({limitedProductAvailableLabel:"global.limitedproduct.available",limitedProductNotAvailableLabel:"global.limitedproduct.notavailable",limitedProductRemainingLabel:"global.limitedproduct.remaining"}),u.default);e.default=l(o.default)},712:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getLimitedProductMessage=void 0;var n=u(a(0)),r=(u(a(1)),u(a(20)));function u(t){return t&&t.__esModule?t:{default:t}}a(475);var o=e.getLimitedProductMessage=function(t,e,a){var n={maxPackagingRuleQuantity:t,maxCustomerQuantity:e},u=function(t,e,a){var n=a.limitedProductNotAvailableLabel,r=a.limitedProductAvailableLabel,u=a.limitedProductRemainingLabel;return 0===e?n:0<e&&e<t?u:r}(t,e,a);return(0,r.default)(u,n)};e.default=function(t){var e=t.product||{},a=e.isLimited,r=e.maxQuantity,u=e.maxCustomerQuantity;if(!a)return null;var i=o(r,u,t);return n.default.createElement("div",{className:"LimitedProductMessage"},i)}},713:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(714);Object.defineProperty(e,"default",{enumerable:!0,get:function(){return function(t){return t&&t.__esModule?t:{default:t}}(n).default}})},714:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=u(a(30)),r=u(a(1));function u(t){return t&&t.__esModule?t:{default:t}}function o(t){var e=document.getElementById(t.domElementId);if(!e)throw new Error("Element with DOM Id '"+t.domElementId+"' not found");return n.default.createPortal(t.children,e)}o.propTypes={children:r.default.any,domElementId:r.default.string},e.default=o}}]);